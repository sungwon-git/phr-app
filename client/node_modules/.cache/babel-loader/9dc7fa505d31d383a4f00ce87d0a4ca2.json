{"ast":null,"code":"import _regeneratorRuntime from \"/Users/sungwonjung/dev/nodejs/phr/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/sungwonjung/dev/nodejs/phr/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _objectWithoutProperties from \"/Users/sungwonjung/dev/nodejs/phr/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\nvar _jsxFileName = \"/Users/sungwonjung/dev/nodejs/phr/client/src/components/OrganizationCard.js\";\nimport React from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { Link as RouterLink } from \"react-router-dom\";\nimport PropTypes from \"prop-types\";\nimport clsx from \"clsx\";\nimport Axios from \"axios\"; // import moment from \"moment\";\n\nimport { Avatar, Box, Button, Card, CardActions, CardMedia, Divider // Grid,\n// IconButton,\n, Link // SvgIcon,\n// Tooltip,\n, Typography, colors, makeStyles } from \"@material-ui/core\"; // import { Rating } from \"@material-ui/lab\";\n// import FavoriteIcon from \"@material-ui/icons/Favorite\";\n// import FavoriteBorderIcon from \"@material-ui/icons/FavoriteBorder\";\n// import { Users as UsersIcon } from \"react-feather\";\n\nimport GetAppIcon from \"@material-ui/icons/GetApp\"; // import ArchiveIcon from \"@material-ui/icons/ArchiveOutlined\";\n\nimport AccountCircle from \"@material-ui/icons/AccountCircle\";\nimport getInitials from \"src/utils/getInitials\";\nvar useStyles = makeStyles(function (theme) {\n  return {\n    root: {},\n    media: {\n      height: 200,\n      backgroundColor: theme.palette.background.dark\n    },\n    likedButton: {\n      color: colors.red[600]\n    },\n    subscribersIcon: {\n      marginLeft: theme.spacing(2),\n      marginRight: theme.spacing(1)\n    },\n    getAppIcon: {\n      marignRight: theme.spacing(1)\n    }\n  };\n});\n\nfunction OrganizationCard(_ref) {\n  var organization = _ref.organization,\n      handleProgress = _ref.handleProgress,\n      handleReceivedDocumentCount = _ref.handleReceivedDocumentCount,\n      className = _ref.className,\n      rest = _objectWithoutProperties(_ref, [\"organization\", \"handleProgress\", \"handleReceivedDocumentCount\", \"className\"]);\n\n  var classes = useStyles();\n\n  var handleLoginButtonClick = function handleLoginButtonClick(e) {\n    console.log(organization);\n    localStorage.setItem(\"organization\", JSON.stringify(organization));\n  };\n\n  var handleDownloadButtonClick = /*#__PURE__*/function () {\n    var _ref2 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee3(event) {\n      var oauth2, fhir_server, organizationID, userID, token, config;\n      return _regeneratorRuntime.wrap(function _callee3$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              handleProgress(true);\n              oauth2 = JSON.parse(localStorage.getItem(\"oauth2Token\"));\n              fhir_server = organization.fhirURL;\n              organizationID = organization.id;\n              userID = oauth2.patientNumber;\n              token = oauth2.value; // console.log(fhir_server);\n\n              console.log(organizationID);\n              console.log(event.target.value); // console.log(userID);\n              // console.log(token);\n\n              config = {\n                method: \"get\",\n                url: \"\".concat(fhir_server, \"/Composition/$documents/\").concat(userID),\n                headers: {\n                  Authorization: \"Bearer \".concat(token)\n                },\n                withCredentials: true\n              }; // console.log(12, config);\n\n              _context4.next = 11;\n              return Axios(config).then( /*#__PURE__*/function () {\n                var _ref3 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee2(response) {\n                  var documents, _loop, i;\n\n                  return _regeneratorRuntime.wrap(function _callee2$(_context3) {\n                    while (1) {\n                      switch (_context3.prev = _context3.next) {\n                        case 0:\n                          // console.log(response.data);\n                          documents = response.data; // console.log(12, documents);\n\n                          _loop = /*#__PURE__*/_regeneratorRuntime.mark(function _loop(i) {\n                            var phr_server, data, phr_config;\n                            return _regeneratorRuntime.wrap(function _loop$(_context2) {\n                              while (1) {\n                                switch (_context2.prev = _context2.next) {\n                                  case 0:\n                                    // console.log(document.id);\n                                    phr_server = \"http://localhost:3100\";\n                                    data = {\n                                      documentID: documents[i].id,\n                                      userID: userID,\n                                      organizationID: organizationID\n                                    };\n                                    phr_config = {\n                                      method: \"post\",\n                                      url: \"\".concat(phr_server, \"/document\"),\n                                      data: data\n                                    }; // console.log(i);\n\n                                    _context2.next = 5;\n                                    return Axios(phr_config).then( /*#__PURE__*/function () {\n                                      var _ref4 = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee(phr_response) {\n                                        var insert_data, insert_config;\n                                        return _regeneratorRuntime.wrap(function _callee$(_context) {\n                                          while (1) {\n                                            switch (_context.prev = _context.next) {\n                                              case 0:\n                                                if (!(phr_response.data.document.length < 1)) {\n                                                  _context.next = 5;\n                                                  break;\n                                                }\n\n                                                insert_data = {\n                                                  documentID: documents[i].id,\n                                                  userID: userID,\n                                                  organizationID: organizationID,\n                                                  document: documents[i],\n                                                  isTransfer: false\n                                                };\n                                                insert_config = {\n                                                  method: \"post\",\n                                                  url: \"\".concat(phr_server, \"/documents/insert\"),\n                                                  data: insert_data\n                                                }; // console.log(insert_data, insert_config);\n\n                                                _context.next = 5;\n                                                return Axios(insert_config).then(function (insert_response) {\n                                                  console.log(insert_response.data);\n                                                  handleProgress(false, insert_response.data.length);\n                                                });\n\n                                              case 5:\n                                              case \"end\":\n                                                return _context.stop();\n                                            }\n                                          }\n                                        }, _callee);\n                                      }));\n\n                                      return function (_x3) {\n                                        return _ref4.apply(this, arguments);\n                                      };\n                                    }()).catch(function (err) {\n                                      console.log(err);\n                                    });\n\n                                  case 5:\n                                  case \"end\":\n                                    return _context2.stop();\n                                }\n                              }\n                            }, _loop);\n                          });\n                          i = 0;\n\n                        case 3:\n                          if (!(i < documents.length)) {\n                            _context3.next = 8;\n                            break;\n                          }\n\n                          return _context3.delegateYield(_loop(i), \"t0\", 5);\n\n                        case 5:\n                          i++;\n                          _context3.next = 3;\n                          break;\n\n                        case 8:\n                          handleReceivedDocumentCount(documents.length);\n\n                        case 9:\n                        case \"end\":\n                          return _context3.stop();\n                      }\n                    }\n                  }, _callee2);\n                }));\n\n                return function (_x2) {\n                  return _ref3.apply(this, arguments);\n                };\n              }()).catch(function (error) {\n                console.log(\"fhir server error\", error);\n              });\n\n            case 11:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee3);\n    }));\n\n    return function handleDownloadButtonClick(_x) {\n      return _ref2.apply(this, arguments);\n    };\n  }(); // console.log(\"organizationCard\", organization);\n\n\n  return /*#__PURE__*/React.createElement(Card, Object.assign({\n    className: clsx(classes.root, className)\n  }, rest, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 147,\n      columnNumber: 3\n    }\n  }), /*#__PURE__*/React.createElement(Box, {\n    p: 3,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 4\n    }\n  }, /*#__PURE__*/React.createElement(CardMedia, {\n    className: classes.media,\n    image: organization.media,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 5\n    }\n  }), /*#__PURE__*/React.createElement(Box, {\n    display: \"flex\",\n    alignItems: \"center\",\n    mt: 2,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Avatar, {\n    alt: \"Author\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 6\n    }\n  }, getInitials(organization.title)), /*#__PURE__*/React.createElement(Box, {\n    ml: 2,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 6\n    }\n  }, /*#__PURE__*/React.createElement(Link, {\n    color: \"textPrimary\",\n    component: RouterLink,\n    to: \"#\",\n    variant: \"h5\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 7\n    }\n  }, organization.title)))), /*#__PURE__*/React.createElement(Box, {\n    pb: 2,\n    px: 3,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159,\n      columnNumber: 4\n    }\n  }, /*#__PURE__*/React.createElement(Typography, {\n    color: \"textSecondary\",\n    variant: \"body2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160,\n      columnNumber: 5\n    }\n  }, \"Address: \", organization.address), /*#__PURE__*/React.createElement(Typography, {\n    color: \"textSecondary\",\n    variant: \"body2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 5\n    }\n  }, \"Postal Code: \", organization.postalCode), /*#__PURE__*/React.createElement(Typography, {\n    color: \"textSecondary\",\n    variant: \"body2\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166,\n      columnNumber: 5\n    }\n  }, \"Telecom: \", organization.telecom)), /*#__PURE__*/React.createElement(Divider, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 170,\n      columnNumber: 4\n    }\n  }), /*#__PURE__*/React.createElement(CardActions, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 171,\n      columnNumber: 4\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    fullWidth: true,\n    onClick: handleLoginButtonClick,\n    href: \"\".concat(organization.oauth2URL, \"?client_id=\").concat(organization.clientID, \"&response_type=\").concat(organization.responseType, \"&redirect_uri=\").concat(organization.redirectURI),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 172,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(AccountCircle, {\n    className: classes.getAppIcon,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 177,\n      columnNumber: 6\n    }\n  }), \"Log in\")), /*#__PURE__*/React.createElement(Divider, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 4\n    }\n  }), /*#__PURE__*/React.createElement(CardActions, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 4\n    }\n  }, /*#__PURE__*/React.createElement(Button, {\n    fullWidth: true,\n    onClick: handleDownloadButtonClick,\n    value: organization.id,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(GetAppIcon, {\n    className: classes.getAppIcon,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 6\n    }\n  }), \"Download\")));\n}\n\nOrganizationCard.propTypes = {\n  className: PropTypes.string,\n  organization: PropTypes.object.isRequired\n};\nexport default OrganizationCard;","map":{"version":3,"sources":["/Users/sungwonjung/dev/nodejs/phr/client/src/components/OrganizationCard.js"],"names":["React","useDispatch","Link","RouterLink","PropTypes","clsx","Axios","Avatar","Box","Button","Card","CardActions","CardMedia","Divider","Typography","colors","makeStyles","GetAppIcon","AccountCircle","getInitials","useStyles","theme","root","media","height","backgroundColor","palette","background","dark","likedButton","color","red","subscribersIcon","marginLeft","spacing","marginRight","getAppIcon","marignRight","OrganizationCard","organization","handleProgress","handleReceivedDocumentCount","className","rest","classes","handleLoginButtonClick","e","console","log","localStorage","setItem","JSON","stringify","handleDownloadButtonClick","event","oauth2","parse","getItem","fhir_server","fhirURL","organizationID","id","userID","patientNumber","token","value","target","config","method","url","headers","Authorization","withCredentials","then","response","documents","data","i","phr_server","documentID","phr_config","phr_response","document","length","insert_data","isTransfer","insert_config","insert_response","catch","err","error","title","address","postalCode","telecom","oauth2URL","clientID","responseType","redirectURI","propTypes","string","object","isRequired"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { Link as RouterLink } from \"react-router-dom\";\nimport PropTypes from \"prop-types\";\nimport clsx from \"clsx\";\nimport Axios from \"axios\";\n// import moment from \"moment\";\nimport {\n\tAvatar,\n\tBox,\n\tButton,\n\tCard,\n\tCardActions,\n\tCardMedia,\n\tDivider,\n\t// Grid,\n\t// IconButton,\n\tLink,\n\t// SvgIcon,\n\t// Tooltip,\n\tTypography,\n\tcolors,\n\tmakeStyles,\n} from \"@material-ui/core\";\n// import { Rating } from \"@material-ui/lab\";\n// import FavoriteIcon from \"@material-ui/icons/Favorite\";\n// import FavoriteBorderIcon from \"@material-ui/icons/FavoriteBorder\";\n// import { Users as UsersIcon } from \"react-feather\";\nimport GetAppIcon from \"@material-ui/icons/GetApp\";\n// import ArchiveIcon from \"@material-ui/icons/ArchiveOutlined\";\nimport AccountCircle from \"@material-ui/icons/AccountCircle\";\nimport getInitials from \"src/utils/getInitials\";\n\nconst useStyles = makeStyles((theme) => ({\n\troot: {},\n\tmedia: {\n\t\theight: 200,\n\t\tbackgroundColor: theme.palette.background.dark,\n\t},\n\tlikedButton: {\n\t\tcolor: colors.red[600],\n\t},\n\tsubscribersIcon: {\n\t\tmarginLeft: theme.spacing(2),\n\t\tmarginRight: theme.spacing(1),\n\t},\n\tgetAppIcon: {\n\t\tmarignRight: theme.spacing(1),\n\t},\n}));\n\nfunction OrganizationCard({ organization, handleProgress, handleReceivedDocumentCount, className, ...rest }) {\n\tconst classes = useStyles();\n\n\tconst handleLoginButtonClick = (e) => {\n\t\tconsole.log(organization);\n\t\tlocalStorage.setItem(\"organization\", JSON.stringify(organization));\n\t};\n\n\tconst handleDownloadButtonClick = async (event) => {\n\t\thandleProgress(true);\n\t\tconst oauth2 = JSON.parse(localStorage.getItem(\"oauth2Token\"));\n\n\t\tconst fhir_server = organization.fhirURL;\n\t\tconst organizationID = organization.id;\n\t\tconst userID = oauth2.patientNumber;\n\t\tconst token = oauth2.value;\n\n\t\t// console.log(fhir_server);\n\t\tconsole.log(organizationID);\n\t\tconsole.log(event.target.value);\n\t\t// console.log(userID);\n\t\t// console.log(token);\n\n\t\tconst config = {\n\t\t\tmethod: \"get\",\n\t\t\turl: `${fhir_server}/Composition/$documents/${userID}`,\n\t\t\theaders: {\n\t\t\t\tAuthorization: `Bearer ${token}`,\n\t\t\t},\n\t\t\twithCredentials: true,\n\t\t};\n\n\t\t// console.log(12, config);\n\n\t\tawait Axios(config)\n\t\t\t.then(async (response) => {\n\t\t\t\t// console.log(response.data);\n\t\t\t\tconst documents = response.data;\n\t\t\t\t// console.log(12, documents);\n\t\t\t\tfor (let i = 0; i < documents.length; i++) {\n\t\t\t\t\t// console.log(document.id);\n\t\t\t\t\tconst phr_server = \"http://localhost:3100\";\n\n\t\t\t\t\tlet data = {\n\t\t\t\t\t\tdocumentID: documents[i].id,\n\t\t\t\t\t\tuserID: userID,\n\t\t\t\t\t\torganizationID: organizationID,\n\t\t\t\t\t};\n\n\t\t\t\t\tlet phr_config = {\n\t\t\t\t\t\tmethod: \"post\",\n\t\t\t\t\t\turl: `${phr_server}/document`,\n\t\t\t\t\t\tdata: data,\n\t\t\t\t\t};\n\t\t\t\t\t// console.log(i);\n\t\t\t\t\tawait Axios(phr_config)\n\t\t\t\t\t\t.then(async (phr_response) => {\n\t\t\t\t\t\t\t// console.log(phr_response);\n\t\t\t\t\t\t\t// console.log(phr_response.data.document.length);\n\t\t\t\t\t\t\tif (phr_response.data.document.length < 1) {\n\t\t\t\t\t\t\t\tconst insert_data = {\n\t\t\t\t\t\t\t\t\tdocumentID: documents[i].id,\n\t\t\t\t\t\t\t\t\tuserID: userID,\n\t\t\t\t\t\t\t\t\torganizationID: organizationID,\n\t\t\t\t\t\t\t\t\tdocument: documents[i],\n\t\t\t\t\t\t\t\t\tisTransfer: false,\n\t\t\t\t\t\t\t\t};\n\n\t\t\t\t\t\t\t\tconst insert_config = {\n\t\t\t\t\t\t\t\t\tmethod: \"post\",\n\t\t\t\t\t\t\t\t\turl: `${phr_server}/documents/insert`,\n\t\t\t\t\t\t\t\t\tdata: insert_data,\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\t// console.log(insert_data, insert_config);\n\n\t\t\t\t\t\t\t\tawait Axios(insert_config).then((insert_response) => {\n\t\t\t\t\t\t\t\t\tconsole.log(insert_response.data);\n\t\t\t\t\t\t\t\t\thandleProgress(false, insert_response.data.length);\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch((err) => {\n\t\t\t\t\t\t\tconsole.log(err);\n\t\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t\thandleReceivedDocumentCount(documents.length);\n\t\t\t})\n\t\t\t.catch((error) => {\n\t\t\t\tconsole.log(\"fhir server error\", error);\n\t\t\t});\n\t};\n\n\t// console.log(\"organizationCard\", organization);\n\n\treturn (\n\t\t<Card className={clsx(classes.root, className)} {...rest}>\n\t\t\t<Box p={3}>\n\t\t\t\t<CardMedia className={classes.media} image={organization.media} />\n\t\t\t\t<Box display=\"flex\" alignItems=\"center\" mt={2}>\n\t\t\t\t\t<Avatar alt=\"Author\">{getInitials(organization.title)}</Avatar>\n\t\t\t\t\t<Box ml={2}>\n\t\t\t\t\t\t<Link color=\"textPrimary\" component={RouterLink} to=\"#\" variant=\"h5\">\n\t\t\t\t\t\t\t{organization.title}\n\t\t\t\t\t\t</Link>\n\t\t\t\t\t</Box>\n\t\t\t\t</Box>\n\t\t\t</Box>\n\t\t\t<Box pb={2} px={3}>\n\t\t\t\t<Typography color=\"textSecondary\" variant=\"body2\">\n\t\t\t\t\tAddress: {organization.address}\n\t\t\t\t</Typography>\n\t\t\t\t<Typography color=\"textSecondary\" variant=\"body2\">\n\t\t\t\t\tPostal Code: {organization.postalCode}\n\t\t\t\t</Typography>\n\t\t\t\t<Typography color=\"textSecondary\" variant=\"body2\">\n\t\t\t\t\tTelecom: {organization.telecom}\n\t\t\t\t</Typography>\n\t\t\t</Box>\n\t\t\t<Divider />\n\t\t\t<CardActions>\n\t\t\t\t<Button\n\t\t\t\t\tfullWidth\n\t\t\t\t\tonClick={handleLoginButtonClick}\n\t\t\t\t\thref={`${organization.oauth2URL}?client_id=${organization.clientID}&response_type=${organization.responseType}&redirect_uri=${organization.redirectURI}`}\n\t\t\t\t>\n\t\t\t\t\t<AccountCircle className={classes.getAppIcon} />\n\t\t\t\t\tLog in\n\t\t\t\t</Button>\n\t\t\t</CardActions>\n\t\t\t<Divider />\n\t\t\t<CardActions>\n\t\t\t\t<Button fullWidth onClick={handleDownloadButtonClick} value={organization.id}>\n\t\t\t\t\t<GetAppIcon className={classes.getAppIcon} />\n\t\t\t\t\tDownload\n\t\t\t\t</Button>\n\t\t\t</CardActions>\n\t\t</Card>\n\t);\n}\n\nOrganizationCard.propTypes = {\n\tclassName: PropTypes.string,\n\torganization: PropTypes.object.isRequired,\n};\n\nexport default OrganizationCard;\n"]},"metadata":{},"sourceType":"module"}