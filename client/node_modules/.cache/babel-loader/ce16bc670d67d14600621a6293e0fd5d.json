{"ast":null,"code":"import _regeneratorRuntime from \"/Users/sungwonjung/dev/nodejs/phr/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/sungwonjung/dev/nodejs/phr/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nvar _jsxFileName = \"/Users/sungwonjung/dev/nodejs/phr/client/src/views/phr/OAuth2/index.js\";\nimport React, { useCallback, useEffect } from \"react\";\nimport { Redirect } from \"react-router-dom\";\nimport qs from \"query-string\";\nimport useIsMountedRef from \"src/hooks/useIsMountedRef\";\nimport Axios from \"axios\";\n\nfunction OAuth2(_ref) {\n  var location = _ref.location;\n  var isMountedRef = useIsMountedRef();\n  var organization = localStorage.getItem(\"organization\");\n  console.log(JSON.parse(organization));\n\n  var _qs$parse = qs.parse(location.search),\n      code = _qs$parse.code;\n\n  console.log(\"OAuth2's code \", code);\n  var getToken = useCallback( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n    var data, client, config;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            data = {\n              code: code,\n              grant_type: \"authorization_code\",\n              redirect_uri: organization.redirectURI\n            };\n            client = Buffer.from(\"\".concat(organization.clientID, \":\").concat(organization.clientSecret), \"utf8\").toString(\"base64\");\n            config = {\n              method: \"post\",\n              url: organization.oauth2URL,\n              headers: {\n                Authorization: \"Basic \".concat(client)\n              },\n              data: data,\n              withCredentials: true\n            };\n            _context.next = 5;\n            return Axios(config).then(function (response) {\n              console.log(response.data);\n            }).catch(function (err) {\n              console.log(\"error \", err);\n            });\n\n          case 5:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  })), [useIsMountedRef]);\n  useEffect(function () {\n    getToken();\n  }, [getToken]); // return <Redirect to=\"/phr\" />;\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 49,\n      columnNumber: 9\n    }\n  });\n}\n\nexport default OAuth2;","map":{"version":3,"sources":["/Users/sungwonjung/dev/nodejs/phr/client/src/views/phr/OAuth2/index.js"],"names":["React","useCallback","useEffect","Redirect","qs","useIsMountedRef","Axios","OAuth2","location","isMountedRef","organization","localStorage","getItem","console","log","JSON","parse","search","code","getToken","data","grant_type","redirect_uri","redirectURI","client","Buffer","from","clientID","clientSecret","toString","config","method","url","oauth2URL","headers","Authorization","withCredentials","then","response","catch","err"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,WAAhB,EAA6BC,SAA7B,QAA8C,OAA9C;AACA,SAASC,QAAT,QAAyB,kBAAzB;AACA,OAAOC,EAAP,MAAe,cAAf;AACA,OAAOC,eAAP,MAA4B,2BAA5B;AACA,OAAOC,KAAP,MAAkB,OAAlB;;AAEA,SAASC,MAAT,OAA8B;AAAA,MAAZC,QAAY,QAAZA,QAAY;AAC7B,MAAMC,YAAY,GAAGJ,eAAe,EAApC;AACA,MAAMK,YAAY,GAAGC,YAAY,CAACC,OAAb,CAAqB,cAArB,CAArB;AAEAC,EAAAA,OAAO,CAACC,GAAR,CAAYC,IAAI,CAACC,KAAL,CAAWN,YAAX,CAAZ;;AAEA,kBAAeN,EAAE,CAACY,KAAH,CAASR,QAAQ,CAACS,MAAlB,CAAf;AAAA,MAAMC,IAAN,aAAMA,IAAN;;AACAL,EAAAA,OAAO,CAACC,GAAR,CAAY,gBAAZ,EAA8BI,IAA9B;AAEA,MAAMC,QAAQ,GAAGlB,WAAW,wEAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AACtBmB,YAAAA,IADsB,GACf;AACZF,cAAAA,IAAI,EAAEA,IADM;AAEZG,cAAAA,UAAU,EAAE,oBAFA;AAGZC,cAAAA,YAAY,EAAEZ,YAAY,CAACa;AAHf,aADe;AAOtBC,YAAAA,MAPsB,GAObC,MAAM,CAACC,IAAP,WAAehB,YAAY,CAACiB,QAA5B,cAAwCjB,YAAY,CAACkB,YAArD,GAAqE,MAArE,EAA6EC,QAA7E,CAAsF,QAAtF,CAPa;AAStBC,YAAAA,MATsB,GASb;AACdC,cAAAA,MAAM,EAAE,MADM;AAEdC,cAAAA,GAAG,EAAEtB,YAAY,CAACuB,SAFJ;AAGdC,cAAAA,OAAO,EAAE;AACRC,gBAAAA,aAAa,kBAAWX,MAAX;AADL,eAHK;AAMdJ,cAAAA,IAAI,EAAEA,IANQ;AAOdgB,cAAAA,eAAe,EAAE;AAPH,aATa;AAAA;AAAA,mBAmBtB9B,KAAK,CAACwB,MAAD,CAAL,CACJO,IADI,CACC,UAACC,QAAD,EAAc;AACnBzB,cAAAA,OAAO,CAACC,GAAR,CAAYwB,QAAQ,CAAClB,IAArB;AACA,aAHI,EAIJmB,KAJI,CAIE,UAACC,GAAD,EAAS;AACf3B,cAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ,EAAsB0B,GAAtB;AACA,aANI,CAnBsB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAD,IA0BzB,CAACnC,eAAD,CA1ByB,CAA5B;AA4BAH,EAAAA,SAAS,CAAC,YAAM;AACfiB,IAAAA,QAAQ;AACR,GAFQ,EAEN,CAACA,QAAD,CAFM,CAAT,CArC6B,CAyC7B;;AACA,sBAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAAP;AACA;;AAED,eAAeZ,MAAf","sourcesContent":["import React, { useCallback, useEffect } from \"react\";\nimport { Redirect } from \"react-router-dom\";\nimport qs from \"query-string\";\nimport useIsMountedRef from \"src/hooks/useIsMountedRef\";\nimport Axios from \"axios\";\n\nfunction OAuth2({ location }) {\n\tconst isMountedRef = useIsMountedRef();\n\tconst organization = localStorage.getItem(\"organization\");\n\n\tconsole.log(JSON.parse(organization));\n\n\tlet { code } = qs.parse(location.search);\n\tconsole.log(\"OAuth2's code \", code);\n\n\tconst getToken = useCallback(async () => {\n\t\tconst data = {\n\t\t\tcode: code,\n\t\t\tgrant_type: \"authorization_code\",\n\t\t\tredirect_uri: organization.redirectURI,\n\t\t};\n\n\t\tconst client = Buffer.from(`${organization.clientID}:${organization.clientSecret}`, \"utf8\").toString(\"base64\");\n\n\t\tconst config = {\n\t\t\tmethod: \"post\",\n\t\t\turl: organization.oauth2URL,\n\t\t\theaders: {\n\t\t\t\tAuthorization: `Basic ${client}`,\n\t\t\t},\n\t\t\tdata: data,\n\t\t\twithCredentials: true,\n\t\t};\n\n\t\tawait Axios(config)\n\t\t\t.then((response) => {\n\t\t\t\tconsole.log(response.data);\n\t\t\t})\n\t\t\t.catch((err) => {\n\t\t\t\tconsole.log(\"error \", err);\n\t\t\t});\n\t}, [useIsMountedRef]);\n\n\tuseEffect(() => {\n\t\tgetToken();\n\t}, [getToken]);\n\n\t// return <Redirect to=\"/phr\" />;\n\treturn <div></div>;\n}\n\nexport default OAuth2;\n"]},"metadata":{},"sourceType":"module"}