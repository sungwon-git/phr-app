{"ast":null,"code":"import _slicedToArray from \"/Users/sungwonjung/dev/nodejs/phr/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectWithoutProperties from \"/Users/sungwonjung/dev/nodejs/phr/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\nvar _jsxFileName = \"/Users/sungwonjung/dev/nodejs/phr/client/src/views/phr/Records/EarningsSegmentation/index.js\";\nimport React, { useState, useEffect, useCallback } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport PropTypes from \"prop-types\";\nimport clsx from \"clsx\";\nimport { Box, Card, CardHeader, Divider, Typography, makeStyles } from \"@material-ui/core\";\nimport GenericMoreButton from \"src/components/GenericMoreButton\"; // import axios from \"src/utils/axios\";\n\nimport useIsMountedRef from \"src/hooks/useIsMountedRef\";\nimport Chart from \"./Chart\";\nvar useStyles = makeStyles(function (theme) {\n  return {\n    root: {},\n    item: {\n      textAlign: \"center\",\n      flexGrow: 1,\n      display: \"flex\",\n      flexDirection: \"column\",\n      justifyContent: \"center\",\n      padding: theme.spacing(3, 2),\n      \"&:not(:last-of-type)\": {\n        borderRight: \"1px solid \".concat(theme.palette.divider)\n      }\n    }\n  };\n});\n\nfunction EarningsSegmentation(_ref) {\n  var _this = this;\n\n  var className = _ref.className,\n      rest = _objectWithoutProperties(_ref, [\"className\"]);\n\n  var classes = useStyles();\n  var organizations = useSelector(function (state) {\n    return state.organizations.organizations;\n  });\n  var documents = useSelector(function (state) {\n    return state.documents.documents;\n  }); // const isMountedRef = useIsMountedRef();\n\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      earnings = _useState2[0],\n      setEarnings = _useState2[1];\n\n  var getEarnings = useCallback(function () {\n    // axios.get(\"/api/reports/earnings\").then((response) => {\n    // \tif (isMountedRef.current) {\n    // \t\tsetEarnings(response.data.earnings);\n    // \t}\n    // });\n    var labels = [];\n    organizations.map(function (organization) {\n      labels.push(organization.title);\n    });\n    var stats = [];\n\n    for (var i = 0; i < organizations.length; i++) {\n      var num = 0;\n\n      for (var j = 0; j < documents.length; j++) {\n        if (organizations[i].id === documents[j].organizationID) {\n          num++;\n        }\n      } // console.log(num);\n\n\n      num = Math.round(num / documents.length * 100);\n      stats.push(num);\n    }\n\n    var earnings = {\n      datasets: [{\n        data: stats,\n        backgroundColor: [\"#3d72eb\", \"#4b9e86\", \"#b658f5\"]\n      }],\n      labels: labels\n    };\n    setEarnings(earnings);\n  }, [documents, organizations]);\n  useEffect(function () {\n    getEarnings();\n  }, [getEarnings]);\n\n  if (!earnings) {\n    return null;\n  }\n\n  return /*#__PURE__*/React.createElement(Card, Object.assign({\n    className: clsx(classes.root, className)\n  }, rest, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 79,\n      columnNumber: 3\n    }\n  }), /*#__PURE__*/React.createElement(CardHeader, {\n    action: /*#__PURE__*/React.createElement(GenericMoreButton, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 80,\n        columnNumber: 24\n      }\n    }),\n    title: \"Documents Segmentation\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80,\n      columnNumber: 4\n    }\n  }), /*#__PURE__*/React.createElement(Divider, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81,\n      columnNumber: 4\n    }\n  }), /*#__PURE__*/React.createElement(Box, {\n    p: 3,\n    position: \"relative\",\n    minHeight: 320,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82,\n      columnNumber: 4\n    }\n  }, /*#__PURE__*/React.createElement(Chart, {\n    data: earnings,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 5\n    }\n  })), /*#__PURE__*/React.createElement(Divider, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 4\n    }\n  }), /*#__PURE__*/React.createElement(Box, {\n    display: \"flex\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 4\n    }\n  }, earnings.labels.map(function (label, i) {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      key: label,\n      className: classes.item,\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 88,\n        columnNumber: 6\n      }\n    }, /*#__PURE__*/React.createElement(Typography, {\n      variant: \"h4\",\n      color: \"textPrimary\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 89,\n        columnNumber: 7\n      }\n    }, earnings.datasets[0].data[i], \"%\"), /*#__PURE__*/React.createElement(Typography, {\n      variant: \"overline\",\n      color: \"textSecondary\",\n      __self: _this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 92,\n        columnNumber: 7\n      }\n    }, label));\n  })));\n}\n\nEarningsSegmentation.propTypes = {\n  className: PropTypes.string\n};\nexport default EarningsSegmentation;","map":{"version":3,"sources":["/Users/sungwonjung/dev/nodejs/phr/client/src/views/phr/Records/EarningsSegmentation/index.js"],"names":["React","useState","useEffect","useCallback","useSelector","PropTypes","clsx","Box","Card","CardHeader","Divider","Typography","makeStyles","GenericMoreButton","useIsMountedRef","Chart","useStyles","theme","root","item","textAlign","flexGrow","display","flexDirection","justifyContent","padding","spacing","borderRight","palette","divider","EarningsSegmentation","className","rest","classes","organizations","state","documents","earnings","setEarnings","getEarnings","labels","map","organization","push","title","stats","i","length","num","j","id","organizationID","Math","round","datasets","data","backgroundColor","label","propTypes","string"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useCallback } from \"react\";\nimport { useSelector } from \"react-redux\";\nimport PropTypes from \"prop-types\";\nimport clsx from \"clsx\";\nimport { Box, Card, CardHeader, Divider, Typography, makeStyles } from \"@material-ui/core\";\nimport GenericMoreButton from \"src/components/GenericMoreButton\";\n// import axios from \"src/utils/axios\";\nimport useIsMountedRef from \"src/hooks/useIsMountedRef\";\nimport Chart from \"./Chart\";\n\nconst useStyles = makeStyles((theme) => ({\n\troot: {},\n\titem: {\n\t\ttextAlign: \"center\",\n\t\tflexGrow: 1,\n\t\tdisplay: \"flex\",\n\t\tflexDirection: \"column\",\n\t\tjustifyContent: \"center\",\n\t\tpadding: theme.spacing(3, 2),\n\t\t\"&:not(:last-of-type)\": {\n\t\t\tborderRight: `1px solid ${theme.palette.divider}`,\n\t\t},\n\t},\n}));\n\nfunction EarningsSegmentation({ className, ...rest }) {\n\tconst classes = useStyles();\n\tconst organizations = useSelector((state) => state.organizations.organizations);\n\tconst documents = useSelector((state) => state.documents.documents);\n\n\t// const isMountedRef = useIsMountedRef();\n\tconst [earnings, setEarnings] = useState(null);\n\n\tconst getEarnings = useCallback(() => {\n\t\t// axios.get(\"/api/reports/earnings\").then((response) => {\n\t\t// \tif (isMountedRef.current) {\n\t\t// \t\tsetEarnings(response.data.earnings);\n\t\t// \t}\n\t\t// });\n\t\tconst labels = [];\n\t\torganizations.map((organization) => {\n\t\t\tlabels.push(organization.title);\n\t\t});\n\n\t\tconst stats = [];\n\t\tfor (let i = 0; i < organizations.length; i++) {\n\t\t\tlet num = 0;\n\t\t\tfor (let j = 0; j < documents.length; j++) {\n\t\t\t\tif (organizations[i].id === documents[j].organizationID) {\n\t\t\t\t\tnum++;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// console.log(num);\n\t\t\tnum = Math.round((num / documents.length) * 100);\n\t\t\tstats.push(num);\n\t\t}\n\n\t\tconst earnings = {\n\t\t\tdatasets: [\n\t\t\t\t{\n\t\t\t\t\tdata: stats,\n\t\t\t\t\tbackgroundColor: [\"#3d72eb\", \"#4b9e86\", \"#b658f5\"],\n\t\t\t\t},\n\t\t\t],\n\t\t\tlabels: labels,\n\t\t};\n\t\tsetEarnings(earnings);\n\t}, [documents, organizations]);\n\n\tuseEffect(() => {\n\t\tgetEarnings();\n\t}, [getEarnings]);\n\n\tif (!earnings) {\n\t\treturn null;\n\t}\n\n\treturn (\n\t\t<Card className={clsx(classes.root, className)} {...rest}>\n\t\t\t<CardHeader action={<GenericMoreButton />} title=\"Documents Segmentation\" />\n\t\t\t<Divider />\n\t\t\t<Box p={3} position=\"relative\" minHeight={320}>\n\t\t\t\t<Chart data={earnings} />\n\t\t\t</Box>\n\t\t\t<Divider />\n\t\t\t<Box display=\"flex\">\n\t\t\t\t{earnings.labels.map((label, i) => (\n\t\t\t\t\t<div key={label} className={classes.item}>\n\t\t\t\t\t\t<Typography variant=\"h4\" color=\"textPrimary\">\n\t\t\t\t\t\t\t{earnings.datasets[0].data[i]}%\n\t\t\t\t\t\t</Typography>\n\t\t\t\t\t\t<Typography variant=\"overline\" color=\"textSecondary\">\n\t\t\t\t\t\t\t{label}\n\t\t\t\t\t\t</Typography>\n\t\t\t\t\t</div>\n\t\t\t\t))}\n\t\t\t</Box>\n\t\t</Card>\n\t);\n}\n\nEarningsSegmentation.propTypes = {\n\tclassName: PropTypes.string,\n};\n\nexport default EarningsSegmentation;\n"]},"metadata":{},"sourceType":"module"}