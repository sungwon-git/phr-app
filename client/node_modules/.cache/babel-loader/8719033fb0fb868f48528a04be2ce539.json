{"ast":null,"code":"import _regeneratorRuntime from \"/Users/sungwonjung/dev/nodejs/phr/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/sungwonjung/dev/nodejs/phr/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nvar _jsxFileName = \"/Users/sungwonjung/dev/nodejs/phr/client/src/views/phr/OAuth2/index.js\";\nimport React, { useCallback, useEffect } from \"react\";\nimport { Redirect } from \"react-router-dom\";\nimport qs from \"query-string\";\nimport useIsMountedRef from \"src/hooks/useIsMountedRef\";\nimport Axios from \"axios\";\n\nfunction OAuth2(_ref) {\n  var location = _ref.location;\n  var isMountedRef = useIsMountedRef();\n  var organization = JSON.parse(localStorage.getItem(\"organization\")); // console.log(JSON.parse(organization));\n\n  var _qs$parse = qs.parse(location.search),\n      code = _qs$parse.code; // console.log(\"OAuth2's code \", code);\n\n\n  var getToken = useCallback( /*#__PURE__*/_asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n    var data, client, config;\n    return _regeneratorRuntime.wrap(function _callee$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            console.log(0, organization);\n            data = {\n              code: code,\n              grant_type: \"authorization_code\",\n              redirect_uri: organization.redirectURI\n            };\n            console.log(1, organization.clientID, organization.clientSecret);\n            client = Buffer.from(\"\".concat(organization.clientID, \":\").concat(organization.clientSecret), \"utf8\").toString(\"base64\"); // PME35XannjCftYHt;\n            // QJmp8JjylHKGDIIITPv2pkA7kw0ylI4BsQfGGh54AqXh5IpUSOEZo8hEF4JUFT8h;\n            // oauth2URL\n            // https://localhost:8000/oauth2/authorize\n            // console.log(organization.oauth2URL);\n\n            config = {\n              method: \"post\",\n              url: organization.oauth2URL,\n              // url: \"https://localhost:8000/oauth2/token\",\n              headers: {\n                Authorization: \"Basic \".concat(client)\n              },\n              data: data,\n              withCredentials: true\n            };\n            console.log(2, config);\n            _context.next = 8;\n            return Axios(config).then(function (response) {\n              console.log(response.data);\n            }).catch(function (err) {\n              console.log(\"error \", err);\n            });\n\n          case 8:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, _callee);\n  })), [useIsMountedRef]);\n  useEffect(function () {\n    getToken();\n  }, [getToken]); // return <Redirect to=\"/phr\" />;\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60,\n      columnNumber: 9\n    }\n  });\n}\n\nexport default OAuth2;","map":{"version":3,"sources":["/Users/sungwonjung/dev/nodejs/phr/client/src/views/phr/OAuth2/index.js"],"names":["React","useCallback","useEffect","Redirect","qs","useIsMountedRef","Axios","OAuth2","location","isMountedRef","organization","JSON","parse","localStorage","getItem","search","code","getToken","console","log","data","grant_type","redirect_uri","redirectURI","clientID","clientSecret","client","Buffer","from","toString","config","method","url","oauth2URL","headers","Authorization","withCredentials","then","response","catch","err"],"mappings":";;;AAAA,OAAOA,KAAP,IAAgBC,WAAhB,EAA6BC,SAA7B,QAA8C,OAA9C;AACA,SAASC,QAAT,QAAyB,kBAAzB;AACA,OAAOC,EAAP,MAAe,cAAf;AACA,OAAOC,eAAP,MAA4B,2BAA5B;AACA,OAAOC,KAAP,MAAkB,OAAlB;;AAEA,SAASC,MAAT,OAA8B;AAAA,MAAZC,QAAY,QAAZA,QAAY;AAC7B,MAAMC,YAAY,GAAGJ,eAAe,EAApC;AACA,MAAMK,YAAY,GAAGC,IAAI,CAACC,KAAL,CAAWC,YAAY,CAACC,OAAb,CAAqB,cAArB,CAAX,CAArB,CAF6B,CAI7B;;AAEA,kBAAeV,EAAE,CAACQ,KAAH,CAASJ,QAAQ,CAACO,MAAlB,CAAf;AAAA,MAAMC,IAAN,aAAMA,IAAN,CAN6B,CAO7B;;;AAEA,MAAMC,QAAQ,GAAGhB,WAAW,wEAAC;AAAA;AAAA;AAAA;AAAA;AAAA;AAC5BiB,YAAAA,OAAO,CAACC,GAAR,CAAY,CAAZ,EAAeT,YAAf;AACMU,YAAAA,IAFsB,GAEf;AACZJ,cAAAA,IAAI,EAAEA,IADM;AAEZK,cAAAA,UAAU,EAAE,oBAFA;AAGZC,cAAAA,YAAY,EAAEZ,YAAY,CAACa;AAHf,aAFe;AAQ5BL,YAAAA,OAAO,CAACC,GAAR,CAAY,CAAZ,EAAeT,YAAY,CAACc,QAA5B,EAAsCd,YAAY,CAACe,YAAnD;AAEMC,YAAAA,MAVsB,GAUbC,MAAM,CAACC,IAAP,WAAelB,YAAY,CAACc,QAA5B,cAAwCd,YAAY,CAACe,YAArD,GAAqE,MAArE,EAA6EI,QAA7E,CAAsF,QAAtF,CAVa,EAY5B;AACA;AACA;AACA;AACA;;AACMC,YAAAA,MAjBsB,GAiBb;AACdC,cAAAA,MAAM,EAAE,MADM;AAEdC,cAAAA,GAAG,EAAEtB,YAAY,CAACuB,SAFJ;AAGd;AACAC,cAAAA,OAAO,EAAE;AACRC,gBAAAA,aAAa,kBAAWT,MAAX;AADL,eAJK;AAOdN,cAAAA,IAAI,EAAEA,IAPQ;AAQdgB,cAAAA,eAAe,EAAE;AARH,aAjBa;AA4B5BlB,YAAAA,OAAO,CAACC,GAAR,CAAY,CAAZ,EAAeW,MAAf;AA5B4B;AAAA,mBA8BtBxB,KAAK,CAACwB,MAAD,CAAL,CACJO,IADI,CACC,UAACC,QAAD,EAAc;AACnBpB,cAAAA,OAAO,CAACC,GAAR,CAAYmB,QAAQ,CAAClB,IAArB;AACA,aAHI,EAIJmB,KAJI,CAIE,UAACC,GAAD,EAAS;AACftB,cAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ,EAAsBqB,GAAtB;AACA,aANI,CA9BsB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,GAAD,IAqCzB,CAACnC,eAAD,CArCyB,CAA5B;AAuCAH,EAAAA,SAAS,CAAC,YAAM;AACfe,IAAAA,QAAQ;AACR,GAFQ,EAEN,CAACA,QAAD,CAFM,CAAT,CAhD6B,CAoD7B;;AACA,sBAAO;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAAP;AACA;;AAED,eAAeV,MAAf","sourcesContent":["import React, { useCallback, useEffect } from \"react\";\nimport { Redirect } from \"react-router-dom\";\nimport qs from \"query-string\";\nimport useIsMountedRef from \"src/hooks/useIsMountedRef\";\nimport Axios from \"axios\";\n\nfunction OAuth2({ location }) {\n\tconst isMountedRef = useIsMountedRef();\n\tconst organization = JSON.parse(localStorage.getItem(\"organization\"));\n\n\t// console.log(JSON.parse(organization));\n\n\tlet { code } = qs.parse(location.search);\n\t// console.log(\"OAuth2's code \", code);\n\n\tconst getToken = useCallback(async () => {\n\t\tconsole.log(0, organization);\n\t\tconst data = {\n\t\t\tcode: code,\n\t\t\tgrant_type: \"authorization_code\",\n\t\t\tredirect_uri: organization.redirectURI,\n\t\t};\n\n\t\tconsole.log(1, organization.clientID, organization.clientSecret);\n\n\t\tconst client = Buffer.from(`${organization.clientID}:${organization.clientSecret}`, \"utf8\").toString(\"base64\");\n\n\t\t// PME35XannjCftYHt;\n\t\t// QJmp8JjylHKGDIIITPv2pkA7kw0ylI4BsQfGGh54AqXh5IpUSOEZo8hEF4JUFT8h;\n\t\t// oauth2URL\n\t\t// https://localhost:8000/oauth2/authorize\n\t\t// console.log(organization.oauth2URL);\n\t\tconst config = {\n\t\t\tmethod: \"post\",\n\t\t\turl: organization.oauth2URL,\n\t\t\t// url: \"https://localhost:8000/oauth2/token\",\n\t\t\theaders: {\n\t\t\t\tAuthorization: `Basic ${client}`,\n\t\t\t},\n\t\t\tdata: data,\n\t\t\twithCredentials: true,\n\t\t};\n\n\t\tconsole.log(2, config);\n\n\t\tawait Axios(config)\n\t\t\t.then((response) => {\n\t\t\t\tconsole.log(response.data);\n\t\t\t})\n\t\t\t.catch((err) => {\n\t\t\t\tconsole.log(\"error \", err);\n\t\t\t});\n\t}, [useIsMountedRef]);\n\n\tuseEffect(() => {\n\t\tgetToken();\n\t}, [getToken]);\n\n\t// return <Redirect to=\"/phr\" />;\n\treturn <div></div>;\n}\n\nexport default OAuth2;\n"]},"metadata":{},"sourceType":"module"}