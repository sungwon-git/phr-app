{"ast":null,"code":"import _slicedToArray from \"/Users/sungwonjung/dev/nodejs/phr/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectWithoutProperties from \"/Users/sungwonjung/dev/nodejs/phr/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\nvar _jsxFileName = \"/Users/sungwonjung/dev/nodejs/phr/client/src/views/chat/ChatView/Message.js\";\nimport React, { useState } from 'react';\nimport { Link as RouterLink } from 'react-router-dom';\nimport { useSelector } from 'react-redux';\nimport PropTypes from 'prop-types';\nimport clsx from 'clsx';\nimport moment from 'moment';\nimport { Lightbox } from 'react-modal-image';\nimport { Avatar, Box, Link, Typography, makeStyles } from '@material-ui/core';\n\nfunction senderSelector(state, senderId) {\n  var user = state.account.user;\n  var contacts = state.chat.contacts;\n\n  if (senderId !== user.id) {\n    var contact = contacts.byId[senderId];\n    return {\n      avatar: contact.avatar,\n      name: contact.name,\n      type: 'contact'\n    };\n  }\n\n  return {\n    avatar: user.avatar,\n    name: 'Me',\n    type: 'user'\n  };\n}\n\nvar useStyles = makeStyles(function (theme) {\n  return {\n    root: {\n      marginBottom: theme.spacing(2),\n      display: 'flex'\n    },\n    avatar: {\n      height: 32,\n      width: 32\n    },\n    image: {\n      cursor: 'pointer',\n      height: 'auto',\n      maxWidth: '100%',\n      width: 380\n    }\n  };\n});\n\nfunction Message(_ref) {\n  var className = _ref.className,\n      message = _ref.message,\n      rest = _objectWithoutProperties(_ref, [\"className\", \"message\"]);\n\n  var classes = useStyles();\n\n  var _useState = useState(null),\n      _useState2 = _slicedToArray(_useState, 2),\n      openedFile = _useState2[0],\n      setOpenedFile = _useState2[1];\n\n  var sender = useSelector(function (state) {\n    return senderSelector(state, message.senderId);\n  });\n  return /*#__PURE__*/React.createElement(\"div\", Object.assign({\n    className: clsx(classes.root, className)\n  }, rest, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 5\n    }\n  }), /*#__PURE__*/React.createElement(Box, {\n    display: \"flex\",\n    maxWidth: 500,\n    ml: sender.type === 'user' ? 'auto' : 0,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Avatar, {\n    className: classes.avatar,\n    src: sender.avatar,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 73,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(Box, {\n    ml: 2,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Box, {\n    bgcolor: sender.type === 'user' ? 'secondary.main' : 'background.default',\n    color: sender.type === 'user' ? 'secondary.contrastText' : 'text.primary',\n    py: 1,\n    px: 2,\n    borderRadius: \"borderRadius\",\n    boxShadow: 1,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Link, {\n    color: \"inherit\",\n    component: RouterLink,\n    to: \"#\",\n    variant: \"h6\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86,\n      columnNumber: 13\n    }\n  }, sender.name), /*#__PURE__*/React.createElement(Box, {\n    mt: 1,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94,\n      columnNumber: 13\n    }\n  }, message.contentType === 'image' ? /*#__PURE__*/React.createElement(Box, {\n    mt: 2,\n    onClick: function onClick() {\n      return setOpenedFile(message.body);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96,\n      columnNumber: 17\n    }\n  }, /*#__PURE__*/React.createElement(\"img\", {\n    alt: \"Attachment\",\n    className: classes.image,\n    src: message.body,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100,\n      columnNumber: 19\n    }\n  })) : /*#__PURE__*/React.createElement(Typography, {\n    color: \"inherit\",\n    variant: \"body1\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107,\n      columnNumber: 17\n    }\n  }, message.body))), /*#__PURE__*/React.createElement(Box, {\n    mt: 1,\n    display: \"flex\",\n    justifyContent: \"flex-end\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 116,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Typography, {\n    noWrap: true,\n    color: \"textSecondary\",\n    variant: \"caption\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 13\n    }\n  }, moment(message.createdAt).fromNow())))), openedFile && /*#__PURE__*/React.createElement(Lightbox, {\n    large: openedFile,\n    onClose: function onClose() {\n      return setOpenedFile(null);\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132,\n      columnNumber: 9\n    }\n  }));\n}\n\nMessage.propTypes = {\n  className: PropTypes.string,\n  message: PropTypes.object.isRequired\n};\nexport default Message;","map":{"version":3,"sources":["/Users/sungwonjung/dev/nodejs/phr/client/src/views/chat/ChatView/Message.js"],"names":["React","useState","Link","RouterLink","useSelector","PropTypes","clsx","moment","Lightbox","Avatar","Box","Typography","makeStyles","senderSelector","state","senderId","user","account","contacts","chat","id","contact","byId","avatar","name","type","useStyles","theme","root","marginBottom","spacing","display","height","width","image","cursor","maxWidth","Message","className","message","rest","classes","openedFile","setOpenedFile","sender","contentType","body","createdAt","fromNow","propTypes","string","object","isRequired"],"mappings":"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","sourcesContent":["import React, { useState } from 'react';\nimport { Link as RouterLink } from 'react-router-dom';\nimport { useSelector } from 'react-redux';\nimport PropTypes from 'prop-types';\nimport clsx from 'clsx';\nimport moment from 'moment';\nimport { Lightbox } from 'react-modal-image';\nimport {\n  Avatar,\n  Box,\n  Link,\n  Typography,\n  makeStyles\n} from '@material-ui/core';\n\nfunction senderSelector(state, senderId) {\n  const { user } = state.account;\n  const { contacts } = state.chat;\n\n  if (senderId !== user.id) {\n    const contact = contacts.byId[senderId];\n\n    return {\n      avatar: contact.avatar,\n      name: contact.name,\n      type: 'contact'\n    };\n  }\n\n  return {\n    avatar: user.avatar,\n    name: 'Me',\n    type: 'user'\n  };\n}\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    marginBottom: theme.spacing(2),\n    display: 'flex'\n  },\n  avatar: {\n    height: 32,\n    width: 32\n  },\n  image: {\n    cursor: 'pointer',\n    height: 'auto',\n    maxWidth: '100%',\n    width: 380\n  }\n}));\n\nfunction Message({\n  className,\n  message,\n  ...rest\n}) {\n  const classes = useStyles();\n  const [openedFile, setOpenedFile] = useState(null);\n  const sender = useSelector((state) => senderSelector(state, message.senderId));\n\n  return (\n    <div\n      className={clsx(classes.root, className)}\n      {...rest}\n    >\n      <Box\n        display=\"flex\"\n        maxWidth={500}\n        ml={sender.type === 'user' ? 'auto' : 0}\n      >\n        <Avatar\n          className={classes.avatar}\n          src={sender.avatar}\n        />\n        <Box ml={2}>\n          <Box\n            bgcolor={sender.type === 'user' ? 'secondary.main' : 'background.default'}\n            color={sender.type === 'user' ? 'secondary.contrastText' : 'text.primary'}\n            py={1}\n            px={2}\n            borderRadius=\"borderRadius\"\n            boxShadow={1}\n          >\n            <Link\n              color=\"inherit\"\n              component={RouterLink}\n              to=\"#\"\n              variant=\"h6\"\n            >\n              {sender.name}\n            </Link>\n            <Box mt={1}>\n              {message.contentType === 'image' ? (\n                <Box\n                  mt={2}\n                  onClick={() => setOpenedFile(message.body)}\n                >\n                  <img\n                    alt=\"Attachment\"\n                    className={classes.image}\n                    src={message.body}\n                  />\n                </Box>\n              ) : (\n                <Typography\n                  color=\"inherit\"\n                  variant=\"body1\"\n                >\n                  {message.body}\n                </Typography>\n              )}\n            </Box>\n          </Box>\n          <Box\n            mt={1}\n            display=\"flex\"\n            justifyContent=\"flex-end\"\n          >\n            <Typography\n              noWrap\n              color=\"textSecondary\"\n              variant=\"caption\"\n            >\n              {moment(message.createdAt).fromNow()}\n            </Typography>\n          </Box>\n        </Box>\n      </Box>\n      {openedFile && (\n        <Lightbox\n          large={openedFile}\n          onClose={() => setOpenedFile(null)}\n        />\n      )}\n    </div>\n  );\n}\n\nMessage.propTypes = {\n  className: PropTypes.string,\n  message: PropTypes.object.isRequired\n};\n\nexport default Message;\n"]},"metadata":{},"sourceType":"module"}