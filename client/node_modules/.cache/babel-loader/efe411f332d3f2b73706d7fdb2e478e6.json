{"ast":null,"code":"import _toConsumableArray from \"/Users/sungwonjung/dev/nodejs/phr/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";\nimport _slicedToArray from \"/Users/sungwonjung/dev/nodejs/phr/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport _objectSpread from \"/Users/sungwonjung/dev/nodejs/phr/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";\nvar _jsxFileName = \"/Users/sungwonjung/dev/nodejs/phr/client/src/views/calendar/CalendarView/index.js\";\nimport React, { useCallback, useState, useRef, useEffect } from 'react';\nimport moment from 'moment';\nimport FullCalendar from '@fullcalendar/react';\nimport dayGridPlugin from '@fullcalendar/daygrid';\nimport timeGridPlugin from '@fullcalendar/timegrid';\nimport interactionPlugin from '@fullcalendar/interaction';\nimport listPlugin from '@fullcalendar/list';\nimport timelinePlugin from '@fullcalendar/timeline';\nimport { Box, Container, Paper, useTheme, useMediaQuery, makeStyles } from '@material-ui/core';\nimport '@fullcalendar/core/main.css';\nimport '@fullcalendar/daygrid/main.css';\nimport '@fullcalendar/timegrid/main.css';\nimport '@fullcalendar/list/main.css';\nimport axios from 'src/utils/axios';\nimport useIsMountedRef from 'src/hooks/useIsMountedRef';\nimport Page from 'src/components/Page';\nimport Header from './Header';\nimport Toolbar from './Toolbar';\nimport AddEditEventModal from './AddEditEventModal';\nvar useStyles = makeStyles(function (theme) {\n  return {\n    root: {\n      backgroundColor: theme.palette.background.dark,\n      minHeight: '100%',\n      paddingTop: theme.spacing(3),\n      paddingBottom: theme.spacing(3)\n    },\n    calendar: {\n      '& .fc-unthemed th': {\n        borderColor: theme.palette.divider\n      },\n      '& .fc-unthemed td': {\n        borderColor: theme.palette.divider\n      },\n      '& .fc-unthemed td.fc-today': {\n        backgroundColor: theme.palette.background.dark\n      },\n      '& .fc-head': {\n        backgroundColor: theme.palette.background.dark\n      },\n      '& .fc-body': {\n        backgroundColor: theme.palette.background.default\n      },\n      '& .fc-axis': _objectSpread({}, theme.typography.body2),\n      '& .fc-list-item-time': _objectSpread({}, theme.typography.body2),\n      '& .fc-list-item-title': _objectSpread({}, theme.typography.body1),\n      '& .fc-list-heading-main': _objectSpread({}, theme.typography.h6),\n      '& .fc-list-heading-alt': _objectSpread({}, theme.typography.h6),\n      '& .fc th': {\n        borderColor: theme.palette.divider\n      },\n      '& .fc-day-header': _objectSpread(_objectSpread({}, theme.typography.subtitle2), {}, {\n        fontWeight: theme.typography.fontWeightMedium,\n        color: theme.palette.text.secondary,\n        padding: theme.spacing(1),\n        backgroundColor: theme.palette.background.dark\n      }),\n      '& .fc-day-top': _objectSpread({}, theme.typography.body2),\n      '& .fc-highlight': {\n        backgroundColor: theme.palette.background.dark\n      },\n      '& .fc-event': {\n        backgroundColor: theme.palette.secondary.main,\n        color: theme.palette.secondary.contrastText,\n        borderWidth: 2,\n        opacity: 0.9,\n        '& .fc-time': _objectSpread(_objectSpread({}, theme.typography.h6), {}, {\n          color: 'inherit'\n        }),\n        '& .fc-title': _objectSpread(_objectSpread({}, theme.typography.body1), {}, {\n          color: 'inherit'\n        })\n      },\n      '& .fc-list-empty': _objectSpread({}, theme.typography.subtitle1)\n    }\n  };\n});\n\nfunction CalendarView() {\n  var classes = useStyles();\n  var calendarRef = useRef(null);\n  var isMountedRef = useIsMountedRef();\n  var theme = useTheme();\n  var mobileDevice = useMediaQuery(theme.breakpoints.down('sm'));\n\n  var _useState = useState(mobileDevice ? 'listWeek' : 'dayGridMonth'),\n      _useState2 = _slicedToArray(_useState, 2),\n      view = _useState2[0],\n      setView = _useState2[1];\n\n  var _useState3 = useState(moment().toDate()),\n      _useState4 = _slicedToArray(_useState3, 2),\n      date = _useState4[0],\n      setDate = _useState4[1];\n\n  var _useState5 = useState(null),\n      _useState6 = _slicedToArray(_useState5, 2),\n      events = _useState6[0],\n      setEvents = _useState6[1];\n\n  var _useState7 = useState({\n    event: null,\n    mode: null,\n    open: false\n  }),\n      _useState8 = _slicedToArray(_useState7, 2),\n      modal = _useState8[0],\n      setModal = _useState8[1];\n\n  var resetModal = function resetModal() {\n    setModal({\n      event: null,\n      mode: null,\n      open: false\n    });\n  };\n\n  var handleDateToday = function handleDateToday() {\n    var calendarEl = calendarRef.current;\n\n    if (calendarEl) {\n      var calendarApi = calendarEl.getApi();\n      calendarApi.today();\n      setDate(calendarApi.getDate());\n    }\n  };\n\n  var handleViewChange = function handleViewChange(newView) {\n    var calendarEl = calendarRef.current;\n\n    if (calendarEl) {\n      var calendarApi = calendarEl.getApi();\n      calendarApi.changeView(newView);\n      setView(newView);\n    }\n  };\n\n  var handleDatePrev = function handleDatePrev() {\n    var calendarEl = calendarRef.current;\n\n    if (calendarEl) {\n      var calendarApi = calendarEl.getApi();\n      calendarApi.prev();\n      setDate(calendarApi.getDate());\n    }\n  };\n\n  var handleDateNext = function handleDateNext() {\n    var calendarEl = calendarRef.current;\n\n    if (calendarEl) {\n      var calendarApi = calendarEl.getApi();\n      calendarApi.next();\n      setDate(calendarApi.getDate());\n    }\n  };\n\n  var handleEventAddClick = function handleEventAddClick() {\n    setModal({\n      mode: 'add',\n      open: true,\n      event: {\n        allDay: false,\n        description: '',\n        end: moment().add(30, 'minutes').toDate(),\n        start: moment().toDate(),\n        title: ''\n      }\n    });\n  };\n\n  var handleSlotsSelect = function handleSlotsSelect(arg) {\n    var calendarEl = calendarRef.current;\n\n    if (calendarEl) {\n      var calendarApi = calendarEl.getApi();\n      calendarApi.unselect();\n    }\n\n    setModal({\n      event: {\n        allDay: arg.allDay,\n        description: '',\n        end: arg.end,\n        start: arg.start,\n        title: ''\n      },\n      mode: 'add',\n      open: true\n    });\n  };\n\n  var handleEventAdd = function handleEventAdd(event) {\n    setEvents(function (prevEvents) {\n      return [].concat(_toConsumableArray(prevEvents), [event]);\n    });\n    resetModal();\n  };\n\n  var handleEventDelete = function handleEventDelete(eventId) {\n    setEvents(function (prevEvents) {\n      return prevEvents.filter(function (prevEvent) {\n        return prevEvent.id !== eventId;\n      });\n    });\n    resetModal();\n  };\n\n  var handleEventSelect = function handleEventSelect(arg) {\n    var event = events.find(function (e) {\n      return e.id === arg.event.id;\n    });\n    setModal({\n      event: _objectSpread({}, event),\n      mode: 'edit',\n      open: true\n    });\n  };\n\n  var handleEventEdit = function handleEventEdit(event) {\n    setEvents(function (prevEvents) {\n      return prevEvents.map(function (prevEvent) {\n        return prevEvent.id === event.id ? event : prevEvent;\n      });\n    });\n    resetModal();\n  };\n\n  var handleEventResize = function handleEventResize(_ref) {\n    var event = _ref.event;\n    // Call API to update the event in database\n    setEvents(function (prevEvents) {\n      return prevEvents.map(function (prevEvent) {\n        return prevEvent.id === event.id ? _objectSpread(_objectSpread({}, prevEvent), {}, {\n          allDay: event.allDay,\n          start: event.start,\n          end: event.end\n        }) : prevEvent;\n      });\n    });\n  };\n\n  var handleEventDrop = function handleEventDrop(_ref2) {\n    var event = _ref2.event;\n    // If you add a droppable area, check if event dropped inside or outside of calendar\n    // Call API to update the event in database\n    setEvents(function (prevEvents) {\n      return prevEvents.map(function (prevEvent) {\n        return prevEvent.id === event.id ? _objectSpread(_objectSpread({}, prevEvent), {}, {\n          allDay: event.allDay,\n          start: event.start,\n          end: event.end\n        }) : prevEvent;\n      });\n    });\n  };\n\n  var handleModalClose = function handleModalClose() {\n    resetModal();\n  };\n\n  var getEvents = useCallback(function () {\n    axios.get('/api/calendar').then(function (response) {\n      if (isMountedRef.current) {\n        setEvents(response.data.events);\n      }\n    });\n  }, [isMountedRef]);\n  useEffect(function () {\n    getEvents();\n  }, [getEvents]);\n  useEffect(function () {\n    var calendarEl = calendarRef.current;\n\n    if (calendarEl) {\n      var calendarApi = calendarEl.getApi();\n      var newView = mobileDevice ? 'listWeek' : 'dayGridMonth';\n      calendarApi.changeView(newView);\n      setView(newView);\n    }\n  }, [mobileDevice]);\n\n  if (!events) {\n    return null;\n  }\n\n  return /*#__PURE__*/React.createElement(Page, {\n    className: classes.root,\n    title: \"Calendar\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 293,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Container, {\n    maxWidth: false,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 297,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(Header, {\n    onEventAdd: handleEventAddClick,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 298,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(Toolbar, {\n    date: date,\n    onDateNext: handleDateNext,\n    onDatePrev: handleDatePrev,\n    onDateToday: handleDateToday,\n    onViewChange: handleViewChange,\n    view: view,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 299,\n      columnNumber: 9\n    }\n  }), /*#__PURE__*/React.createElement(Paper, {\n    className: classes.calendar,\n    component: Box,\n    mt: 3,\n    p: 2,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 307,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(FullCalendar, {\n    allDayMaintainDuration: true,\n    defaultDate: date,\n    defaultView: view,\n    droppable: true,\n    editable: true,\n    eventClick: handleEventSelect,\n    eventDrop: handleEventDrop,\n    eventLimit: true,\n    eventResizableFromStart: true,\n    eventResize: handleEventResize,\n    events: events,\n    header: false,\n    height: 800,\n    ref: calendarRef,\n    rerenderDelay: 10,\n    select: handleSlotsSelect,\n    selectable: true,\n    weekends: true,\n    plugins: [dayGridPlugin, timeGridPlugin, interactionPlugin, listPlugin, timelinePlugin],\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 313,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(AddEditEventModal, {\n    event: modal.event,\n    mode: modal.mode,\n    onAdd: handleEventAdd,\n    onCancel: handleModalClose,\n    onDelete: handleEventDelete,\n    onEdit: handleEventEdit,\n    open: modal.open,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 341,\n      columnNumber: 9\n    }\n  })));\n}\n\nexport default CalendarView;","map":{"version":3,"sources":["/Users/sungwonjung/dev/nodejs/phr/client/src/views/calendar/CalendarView/index.js"],"names":["React","useCallback","useState","useRef","useEffect","moment","FullCalendar","dayGridPlugin","timeGridPlugin","interactionPlugin","listPlugin","timelinePlugin","Box","Container","Paper","useTheme","useMediaQuery","makeStyles","axios","useIsMountedRef","Page","Header","Toolbar","AddEditEventModal","useStyles","theme","root","backgroundColor","palette","background","dark","minHeight","paddingTop","spacing","paddingBottom","calendar","borderColor","divider","default","typography","body2","body1","h6","subtitle2","fontWeight","fontWeightMedium","color","text","secondary","padding","main","contrastText","borderWidth","opacity","subtitle1","CalendarView","classes","calendarRef","isMountedRef","mobileDevice","breakpoints","down","view","setView","toDate","date","setDate","events","setEvents","event","mode","open","modal","setModal","resetModal","handleDateToday","calendarEl","current","calendarApi","getApi","today","getDate","handleViewChange","newView","changeView","handleDatePrev","prev","handleDateNext","next","handleEventAddClick","allDay","description","end","add","start","title","handleSlotsSelect","arg","unselect","handleEventAdd","prevEvents","handleEventDelete","eventId","filter","prevEvent","id","handleEventSelect","find","e","handleEventEdit","map","handleEventResize","handleEventDrop","handleModalClose","getEvents","get","then","response","data"],"mappings":"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","sourcesContent":["import React, {\n  useCallback,\n  useState,\n  useRef,\n  useEffect\n} from 'react';\nimport moment from 'moment';\nimport FullCalendar from '@fullcalendar/react';\nimport dayGridPlugin from '@fullcalendar/daygrid';\nimport timeGridPlugin from '@fullcalendar/timegrid';\nimport interactionPlugin from '@fullcalendar/interaction';\nimport listPlugin from '@fullcalendar/list';\nimport timelinePlugin from '@fullcalendar/timeline';\nimport {\n  Box,\n  Container,\n  Paper,\n  useTheme,\n  useMediaQuery,\n  makeStyles\n} from '@material-ui/core';\nimport '@fullcalendar/core/main.css';\nimport '@fullcalendar/daygrid/main.css';\nimport '@fullcalendar/timegrid/main.css';\nimport '@fullcalendar/list/main.css';\nimport axios from 'src/utils/axios';\nimport useIsMountedRef from 'src/hooks/useIsMountedRef';\nimport Page from 'src/components/Page';\nimport Header from './Header';\nimport Toolbar from './Toolbar';\nimport AddEditEventModal from './AddEditEventModal';\n\nconst useStyles = makeStyles((theme) => ({\n  root: {\n    backgroundColor: theme.palette.background.dark,\n    minHeight: '100%',\n    paddingTop: theme.spacing(3),\n    paddingBottom: theme.spacing(3)\n  },\n  calendar: {\n    '& .fc-unthemed th': {\n      borderColor: theme.palette.divider\n    },\n    '& .fc-unthemed td': {\n      borderColor: theme.palette.divider\n    },\n    '& .fc-unthemed td.fc-today': {\n      backgroundColor: theme.palette.background.dark\n    },\n    '& .fc-head': {\n      backgroundColor: theme.palette.background.dark\n    },\n    '& .fc-body': {\n      backgroundColor: theme.palette.background.default\n    },\n    '& .fc-axis': {\n      ...theme.typography.body2\n    },\n    '& .fc-list-item-time': {\n      ...theme.typography.body2\n    },\n    '& .fc-list-item-title': {\n      ...theme.typography.body1\n    },\n    '& .fc-list-heading-main': {\n      ...theme.typography.h6\n    },\n    '& .fc-list-heading-alt': {\n      ...theme.typography.h6\n    },\n    '& .fc th': {\n      borderColor: theme.palette.divider\n    },\n    '& .fc-day-header': {\n      ...theme.typography.subtitle2,\n      fontWeight: theme.typography.fontWeightMedium,\n      color: theme.palette.text.secondary,\n      padding: theme.spacing(1),\n      backgroundColor: theme.palette.background.dark\n    },\n    '& .fc-day-top': {\n      ...theme.typography.body2\n    },\n    '& .fc-highlight': {\n      backgroundColor: theme.palette.background.dark\n    },\n    '& .fc-event': {\n      backgroundColor: theme.palette.secondary.main,\n      color: theme.palette.secondary.contrastText,\n      borderWidth: 2,\n      opacity: 0.9,\n      '& .fc-time': {\n        ...theme.typography.h6,\n        color: 'inherit'\n      },\n      '& .fc-title': {\n        ...theme.typography.body1,\n        color: 'inherit'\n      }\n    },\n    '& .fc-list-empty': {\n      ...theme.typography.subtitle1\n    }\n  }\n}));\n\nfunction CalendarView() {\n  const classes = useStyles();\n  const calendarRef = useRef(null);\n  const isMountedRef = useIsMountedRef();\n  const theme = useTheme();\n  const mobileDevice = useMediaQuery(theme.breakpoints.down('sm'));\n  const [view, setView] = useState(mobileDevice ? 'listWeek' : 'dayGridMonth');\n  const [date, setDate] = useState(moment().toDate());\n  const [events, setEvents] = useState(null);\n  const [modal, setModal] = useState({\n    event: null,\n    mode: null,\n    open: false\n  });\n\n  const resetModal = () => {\n    setModal({\n      event: null,\n      mode: null,\n      open: false\n    });\n  };\n\n  const handleDateToday = () => {\n    const calendarEl = calendarRef.current;\n\n    if (calendarEl) {\n      const calendarApi = calendarEl.getApi();\n\n      calendarApi.today();\n      setDate(calendarApi.getDate());\n    }\n  };\n\n  const handleViewChange = (newView) => {\n    const calendarEl = calendarRef.current;\n\n    if (calendarEl) {\n      const calendarApi = calendarEl.getApi();\n\n      calendarApi.changeView(newView);\n      setView(newView);\n    }\n  };\n\n  const handleDatePrev = () => {\n    const calendarEl = calendarRef.current;\n\n    if (calendarEl) {\n      const calendarApi = calendarEl.getApi();\n\n      calendarApi.prev();\n      setDate(calendarApi.getDate());\n    }\n  };\n\n  const handleDateNext = () => {\n    const calendarEl = calendarRef.current;\n\n    if (calendarEl) {\n      const calendarApi = calendarEl.getApi();\n\n      calendarApi.next();\n      setDate(calendarApi.getDate());\n    }\n  };\n\n  const handleEventAddClick = () => {\n    setModal({\n      mode: 'add',\n      open: true,\n      event: {\n        allDay: false,\n        description: '',\n        end: moment().add(30, 'minutes').toDate(),\n        start: moment().toDate(),\n        title: ''\n      }\n    });\n  };\n\n  const handleSlotsSelect = (arg) => {\n    const calendarEl = calendarRef.current;\n\n    if (calendarEl) {\n      const calendarApi = calendarEl.getApi();\n\n      calendarApi.unselect();\n    }\n\n    setModal({\n      event: {\n        allDay: arg.allDay,\n        description: '',\n        end: arg.end,\n        start: arg.start,\n        title: ''\n      },\n      mode: 'add',\n      open: true\n    });\n  };\n\n  const handleEventAdd = (event) => {\n    setEvents((prevEvents) => [...prevEvents, event]);\n    resetModal();\n  };\n\n  const handleEventDelete = (eventId) => {\n    setEvents((prevEvents) => prevEvents.filter((prevEvent) => prevEvent.id !== eventId));\n    resetModal();\n  };\n\n  const handleEventSelect = (arg) => {\n    const event = events.find((e) => e.id === arg.event.id);\n\n    setModal({\n      event: { ...event },\n      mode: 'edit',\n      open: true\n    });\n  };\n\n  const handleEventEdit = (event) => {\n    setEvents((prevEvents) => prevEvents.map((prevEvent) => (\n      prevEvent.id === event.id ? event : prevEvent\n    )));\n    resetModal();\n  };\n\n  const handleEventResize = ({ event }) => {\n    // Call API to update the event in database\n    setEvents((prevEvents) => prevEvents.map((prevEvent) => (prevEvent.id === event.id ? ({\n      ...prevEvent,\n      allDay: event.allDay,\n      start: event.start,\n      end: event.end\n    }) : prevEvent)));\n  };\n\n  const handleEventDrop = ({ event }) => {\n    // If you add a droppable area, check if event dropped inside or outside of calendar\n    // Call API to update the event in database\n    setEvents((prevEvents) => prevEvents.map((prevEvent) => (prevEvent.id === event.id ? ({\n      ...prevEvent,\n      allDay: event.allDay,\n      start: event.start,\n      end: event.end\n    }) : prevEvent)));\n  };\n\n  const handleModalClose = () => {\n    resetModal();\n  };\n\n  const getEvents = useCallback(() => {\n    axios\n      .get('/api/calendar')\n      .then((response) => {\n        if (isMountedRef.current) {\n          setEvents(response.data.events);\n        }\n      });\n  }, [isMountedRef]);\n\n  useEffect(() => {\n    getEvents();\n  }, [getEvents]);\n\n  useEffect(() => {\n    const calendarEl = calendarRef.current;\n\n    if (calendarEl) {\n      const calendarApi = calendarEl.getApi();\n      const newView = mobileDevice ? 'listWeek' : 'dayGridMonth';\n\n      calendarApi.changeView(newView);\n      setView(newView);\n    }\n  }, [mobileDevice]);\n\n  if (!events) {\n    return null;\n  }\n\n  return (\n    <Page\n      className={classes.root}\n      title=\"Calendar\"\n    >\n      <Container maxWidth={false}>\n        <Header onEventAdd={handleEventAddClick} />\n        <Toolbar\n          date={date}\n          onDateNext={handleDateNext}\n          onDatePrev={handleDatePrev}\n          onDateToday={handleDateToday}\n          onViewChange={handleViewChange}\n          view={view}\n        />\n        <Paper\n          className={classes.calendar}\n          component={Box}\n          mt={3}\n          p={2}\n        >\n          <FullCalendar\n            allDayMaintainDuration\n            defaultDate={date}\n            defaultView={view}\n            droppable\n            editable\n            eventClick={handleEventSelect}\n            eventDrop={handleEventDrop}\n            eventLimit\n            eventResizableFromStart\n            eventResize={handleEventResize}\n            events={events}\n            header={false}\n            height={800}\n            ref={calendarRef}\n            rerenderDelay={10}\n            select={handleSlotsSelect}\n            selectable\n            weekends\n            plugins={[\n              dayGridPlugin,\n              timeGridPlugin,\n              interactionPlugin,\n              listPlugin,\n              timelinePlugin\n            ]}\n          />\n        </Paper>\n        <AddEditEventModal\n          event={modal.event}\n          mode={modal.mode}\n          onAdd={handleEventAdd}\n          onCancel={handleModalClose}\n          onDelete={handleEventDelete}\n          onEdit={handleEventEdit}\n          open={modal.open}\n        />\n      </Container>\n    </Page>\n  );\n}\n\nexport default CalendarView;\n"]},"metadata":{},"sourceType":"module"}